{% extends "base.html" %}
{% load i18n %}

{% block title %}Log in{% endblock %}

{# TBD: figure out an appropriate navbar (that isn't hardcoded into every page!) #}
{% block navbar %}
   <li class="first"><a href="{{ shop_base }}/">{% trans "Home" %}</a></li>
{% endblock %}

{% block content %}

    {% if form.non_field_errors %}
        <p class="error">{% for err in form.non_field_errors %}{{ err }}{% if not forloop.last %}<br/>{% endif %}
        {% endfor %}</p>
    {% endif %}

    <form method="post" action=".">{% csrf_token %}

    {# TBD: delete! #}
    <!-- <p style="color: red">test login: test2/test</p>  -->

        <table class="noborder">
    {# Satchmo prompts for 'Email address'; might switch to that later #}
            <tr><td><label for="id_username">{% trans 'Username' %}:</label></td><td>{{ form.username }}</td></tr>
            {% if form.username.errors %}<tr><td class="error" colspan="2">***{{ form.username.errors|join:", " }}</td></tr>{% endif %}
            <tr><td><label for="id_password">{% trans 'Password' %}:</label></td><td>{{ form.password }}</td></tr>
            {% if form.password.errors %}<tr><td class="error" colspan="2">***{{ form.password.errors|join:", " }}</td></tr>{% endif %}
        </table>

        <input type="submit" value="{% trans 'Login' %}" />
        <input type="hidden" name="next" value={{ next }} />
    </form>

    {% comment %} We jump through hoops with the urls so it doesn't bomb with django's built in unit tests.{% endcomment %}
    {% url 'registration_register' as registration_register %}
    {% url 'auth_password_reset' as auth_password_reset %}
    {% if registration_register %}
        <p>{% trans "If you do not have an account, please" %} <a href="{% url 'registration_register' %}">{% trans "register" %}</a>.</p>
    {% endif %}
    {% if auth_password_reset %}
        <p>{% trans "If you forgot your password: " %} <a href="{% url 'auth_password_reset' %}">{% trans "reset password" %}</a>.</p>
    {% endif %}

{% endblock %}
